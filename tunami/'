var tunami = tunami || {};
var requestFileSystem = window.requestFileSystem || window.webkitRequestFileSystem;

tunami.library = {
  init: (function() {
    requestFileSystem(TEMPORARY, tunami.utility.fsSize, function(fs) {
      var dirName = 'library', options;
      function readFiles(directory) {
        tunami.library.directory = directory;
        directory.createReader().readEntries(function(entries) {
          List = new tunami.List(file.name);
          tunami.library.List = List;
          for (var i in entries) List.importZip(entries[i]);
        });
      }
      
      options = {create: true, exclusive: false};
      fs.root.getDirectory(dirName, options, readFiles, readFiles);
    });
  })(),
  getArchive: function getArchive(index, callback) {
    var options = {create: true, exclusive: false};
    var filename = 'part-' + index;
    tunami.library.directory.getFile(filename, options, function(fileEntry) {
      callback(fileEntry);
    });
  }
}

